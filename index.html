<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–Æ–ª—è: –ü—Ä–∏–∑–≤–∞–Ω–∏–µ –≤—Ä–∞—á–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 15px;
            line-height: 1.5;
        }

        .game-container {
            max-width: 100%;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-height: 85vh;
        }

        .character-img {
            text-align: center;
            font-size: 60px;
            margin: 10px 0;
        }

        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin: 15px 0;
            background: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 10px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px;
        }

        .stat-bar {
            width: 60px;
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            overflow: hidden;
        }

        .stat-fill {
            height: 100%;
            background: #4CAF50;
            transition: width 0.3s ease;
        }

        .health .stat-fill { background: #f44336; }
        .energy .stat-fill { background: #ff9800; }
        .knowledge .stat-fill { background: #2196F3; }
        .money .stat-fill { background: #4CAF50; }

        .story-text {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            min-height: 120px;
            font-size: 14px;
        }

        .choices {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin: 15px 0;
        }

        .choice-btn {
            background: linear-gradient(45deg, #FF5722, #E64A19);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .choice-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .choice-btn:active {
            transform: translateY(0);
        }

        .choice-btn.secondary {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }

        .choice-btn.success {
            background: linear-gradient(45deg, #4CAF50, #45a049);
        }

        .choice-btn.warning {
            background: linear-gradient(45deg, #ff9800, #f57c00);
        }

        .location {
            text-align: center;
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 10px;
        }

        .day-counter {
            text-align: center;
            font-size: 12px;
            margin-bottom: 10px;
            background: rgba(255,255,255,0.2);
            padding: 5px;
            border-radius: 20px;
        }

        .event-result {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 13px;
            border-left: 4px solid #4CAF50;
        }

        .hidden {
            display: none;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div id="loadingScreen">
            <div class="character-img">üë©‚Äç‚öïÔ∏è</div>
            <div class="story-text">
                <h2>–Æ–ª—è: –ü—Ä–∏–∑–≤–∞–Ω–∏–µ –≤—Ä–∞—á–∞</h2>
                <p>–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∞—à–µ–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –∫–∞—Ä—å–µ—Ä—ã...</p>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
        <div id="gameScreen" class="hidden">
            <!-- –°—Ç–∞—Ç—É—Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ -->
            <div class="character-img" id="characterEmoji">üë©‚Äçüéì</div>
            <div class="location" id="location">–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç</div>
            <div class="day-counter" id="dayCounter">–î–µ–Ω—å 1 –∏–∑ 30</div>
            
            <div class="stats">
                <div class="stat-item">
                    <span>‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ</span>
                    <div class="stat-bar"><div class="stat-fill health" id="healthBar" style="width: 100%;"></div></div>
                </div>
                <div class="stat-item">
                    <span>‚ö° –≠–Ω–µ—Ä–≥–∏—è</span>
                    <div class="stat-bar"><div class="stat-fill energy" id="energyBar" style="width: 100%;"></div></div>
                </div>
                <div class="stat-item">
                    <span>üìö –ó–Ω–∞–Ω–∏—è</span>
                    <div class="stat-bar"><div class="stat-fill knowledge" id="knowledgeBar" style="width: 30%;"></div></div>
                </div>
                <div class="stat-item">
                    <span>üí∞ –î–µ–Ω—å–≥–∏</span>
                    <div class="stat-bar"><div class="stat-fill money" id="moneyBar" style="width: 50%;"></div></div>
                </div>
            </div>

            <!-- –¢–µ–∫—Å—Ç –∏—Å—Ç–æ—Ä–∏–∏ -->
            <div class="story-text" id="storyText">
                –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç! –í—ã - –Æ–ª—è, —Ä—ã–∂–µ–≤–æ–ª–æ—Å–∞—è –∑–µ–ª–µ–Ω–æ–≥–ª–∞–∑–∞—è —Å—Ç—É–¥–µ–Ω—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –º–µ—á—Ç–∞–µ—Ç —Å—Ç–∞—Ç—å –≤—Ä–∞—á–æ–º. –í–∞—à –ø—É—Ç—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è...
            </div>

            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–±—ã—Ç–∏—è -->
            <div class="event-result hidden" id="eventResult"></div>

            <!-- –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ -->
            <div class="choices" id="choicesContainer">
                <!-- –ö–Ω–æ–ø–∫–∏ –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã -->
        <div id="endScreen" class="hidden">
            <div class="character-img">üèÜ</div>
            <div class="story-text" id="endText">
                <!-- –¢–µ–∫—Å—Ç –æ–∫–æ–Ω—á–∞–Ω–∏—è –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            <div class="choices">
                <button class="choice-btn success" onclick="restartGame()">üéÆ –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                <button class="choice-btn" onclick="saveResults()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
            </div>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞
        let player = {
            health: 100,
            energy: 100,
            knowledge: 30,
            money: 5000,
            day: 1,
            maxDays: 30,
            reputation: 0,
            location: "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç",
            storyProgress: 0
        };

        // –ò–≥—Ä–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è
        const gameEvents = [
            // –î–µ–Ω—å 1-5: –ù–∞—á–∞–ª–æ –æ–±—É—á–µ–Ω–∏—è
            {
                id: 1,
                text: "–ü–µ—Ä–≤—ã–π –¥–µ–Ω—å –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–º —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ! –í—ã —Å–∏–¥–∏—Ç–µ –Ω–∞ –ª–µ–∫—Ü–∏–∏ –ø–æ –∞–Ω–∞—Ç–æ–º–∏–∏. –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –ø–∞—Ä –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π.",
                choices: [
                    { text: "‚úÖ –û—Å—Ç–∞—Ç—å—Å—è –Ω–∞ –¥–æ–ø. –∑–∞–Ω—è—Ç–∏—è", effect: { energy: -20, knowledge: +15 }, next: 2 },
                    { text: "üö∂‚Äç‚ôÄÔ∏è –£–π—Ç–∏ –¥–æ–º–æ–π –æ—Ç–¥—ã—Ö–∞—Ç—å", effect: { energy: +10, knowledge: +5 }, next: 3 }
                ]
            },
            {
                id: 2,
                text: "–í—ã –æ—Å—Ç–∞–ª–∏—Å—å –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è. –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –∑–∞–º–µ—Ç–∏–ª –≤–∞—à–µ —É—Å–µ—Ä–¥–∏–µ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏–ª —Å—Ç–∞—Ç—å –µ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –ø—Ä–æ–µ–∫—Ç–µ!",
                choices: [
                    { text: "üéØ –°–æ–≥–ª–∞—Å–∏—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–µ–∫—Ç", effect: { energy: -15, knowledge: +20, money: +1000 }, next: 4 },
                    { text: "üìö –í–µ–∂–ª–∏–≤–æ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è", effect: { knowledge: +10 }, next: 5 }
                ]
            },
            {
                id: 3,
                text: "–í—ã —Ä–µ—à–∏–ª–∏ –æ—Ç–¥–æ—Ö–Ω—É—Ç—å. –ü–æ –ø—É—Ç–∏ –¥–æ–º–æ–π –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –æ–¥–Ω–æ–≥—Ä—É–ø–ø–Ω–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–ª–æ–∂–∏–ª –≤–º–µ—Å—Ç–µ –≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ —ç–∫–∑–∞–º–µ–Ω–∞–º.",
                choices: [
                    { text: "üë• –°–æ–≥–ª–∞—Å–∏—Ç—å—Å—è –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–Ω—É—é –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É", effect: { knowledge: +10, energy: -10 }, next: 6 },
                    { text: "üè† –ü–æ–π—Ç–∏ –¥–æ–º–æ–π –æ–¥–Ω–æ–π", effect: { energy: +15 }, next: 7 }
                ]
            },
            // –î–µ–Ω—å 6-10: –ü–µ—Ä–≤–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞
            {
                id: 4,
                text: "–ù–∞—á–∞–ª–∞—Å—å –ø–µ—Ä–≤–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –≤ –±–æ–ª—å–Ω–∏—Ü–µ! –í–∞—Å –Ω–∞–ø—Ä–∞–≤–∏–ª–∏ –≤ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ–π –ø–æ–º–æ—â–∏. –ü–æ—Å—Ç—É–ø–∞–µ—Ç –ø–∞—Ü–∏–µ–Ω—Ç —Å –æ—Å—Ç—Ä—ã–º–∏ –±–æ–ª—è–º–∏ –≤ –∂–∏–≤–æ—Ç–µ.",
                choices: [
                    { text: "üîç –¢—â–∞—Ç–µ–ª—å–Ω–æ –æ–±—Å–ª–µ–¥–æ–≤–∞—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞", effect: { knowledge: +15, energy: -20 }, next: 8 },
                    { text: "üíä –î–∞—Ç—å –æ–±–µ–∑–±–æ–ª–∏–≤–∞—é—â–µ–µ –∏ –Ω–∞–±–ª—é–¥–∞—Ç—å", effect: { knowledge: +5, energy: -10 }, next: 9 }
                ]
            },
            {
                id: 5,
                text: "–í–æ –≤—Ä–µ–º—è –¥–µ–∂—É—Ä—Å—Ç–≤–∞ –∫ –≤–∞–º –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–∂–∏–ª–∞—è –ø–∞—Ü–∏–µ–Ω—Ç–∫–∞. –û–Ω–∞ –ø—Ä–æ—Å–∏—Ç –ø–æ–º–æ—â–∏, –Ω–æ —É –≤–∞—Å –º–Ω–æ–≥–æ —Ä–∞–±–æ—Ç—ã.",
                choices: [
                    { text: "üëµ –ü–æ–º–æ—á—å –ø–∞—Ü–∏–µ–Ω—Ç–∫–µ", effect: { energy: -15, reputation: +10 }, next: 10 },
                    { text: "‚è∞ –í–µ–∂–ª–∏–≤–æ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è", effect: { reputation: -5 }, next: 11 }
                ]
            },
            // –î–µ–Ω—å 11-15: –°–ª–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
            {
                id: 6,
                text: "–ù–∞ –æ–±—Ö–æ–¥–µ –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç–µ, —á—Ç–æ –ø–∞—Ü–∏–µ–Ω—Ç—É —Å—Ç–∞–ª–æ —Ö—É–∂–µ. –ù—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ!",
                choices: [
                    { text: "üö® –í—ã–∑–≤–∞—Ç—å —Å—Ç–∞—Ä—à–µ–≥–æ –≤—Ä–∞—á–∞", effect: { knowledge: +10, reputation: +5 }, next: 12 },
                    { text: "üíâ –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –æ–∫–∞–∑–∞—Ç—å –ø–æ–º–æ—â—å", effect: { knowledge: +20, health: -10, reputation: +15 }, next: 13 }
                ]
            },
            {
                id: 7,
                text: "–í–∞–º –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç —É—á–∞—Å—Ç–∏–µ –≤ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏, –Ω–æ –Ω—É–∂–Ω–æ –≥–æ—Ç–æ–≤–∏—Ç—å –¥–æ–∫–ª–∞–¥ –≤ —É—â–µ—Ä–± –æ—Ç–¥—ã—Ö—É.",
                choices: [
                    { text: "‚úàÔ∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–æ–∫–ª–∞–¥ –¥–ª—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏", effect: { knowledge: +25, energy: -30, money: +2000 }, next: 14 },
                    { text: "üò¥ –û—Ç–¥–æ—Ö–Ω—É—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∏–ª—ã", effect: { energy: +25, health: +10 }, next: 15 }
                ]
            },
            // –î–µ–Ω—å 16-20: –ö—Ä–∏–∑–∏—Å
            {
                id: 8,
                text: "–≠–ø–∏–¥–µ–º–∏—è –≥—Ä–∏–ø–ø–∞! –ë–æ–ª—å–Ω–∏—Ü–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∞, –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å–≤–µ—Ä—Ö—É—Ä–æ—á–Ω–æ. –ß—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–∏–ª—å–Ω—É—é —É—Å—Ç–∞–ª–æ—Å—Ç—å.",
                choices: [
                    { text: "üí™ –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å", effect: { health: -20, energy: -30, reputation: +20 }, next: 16 },
                    { text: "üè• –í–∑—è—Ç—å –ø–µ—Ä–µ—Ä—ã–≤", effect: { health: +10, energy: +15, reputation: -10 }, next: 17 }
                ]
            },
            // –î–µ–Ω—å 21-25: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            {
                id: 9,
                text: "–ü—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –≤—ã–±–∏—Ä–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é! –ö—É–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–π—Ç–∏?",
                choices: [
                    { text: "‚ù§Ô∏è –ö–∞—Ä–¥–∏–æ–ª–æ–≥–∏—è", effect: { knowledge: +20 }, next: 18 },
                    { text: "üß† –ù–µ–≤—Ä–æ–ª–æ–≥–∏—è", effect: { knowledge: +15 }, next: 19 },
                    { text: "üë∂ –ü–µ–¥–∏–∞—Ç—Ä–∏—è", effect: { knowledge: +10, reputation: +10 }, next: 20 }
                ]
            },
            // –î–µ–Ω—å 26-30: –§–∏–Ω–∞–ª—å–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è
            {
                id: 10,
                text: "–í—ã–ø—É—Å–∫–Ω—ã–µ —ç–∫–∑–∞–º–µ–Ω—ã! –û—Ç –≤–∞—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–≤–∏—Å–∏—Ç –±—É–¥—É—â–∞—è –∫–∞—Ä—å–µ—Ä–∞. –ö–∞–∫ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤–∏—Ç—å—Å—è?",
                choices: [
                    { text: "üìö –£—Å–µ—Ä–¥–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞", effect: { knowledge: +30, energy: -40 }, next: 21 },
                    { text: "‚öñÔ∏è –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥", effect: { knowledge: +20, energy: -20, health: -10 }, next: 22 }
                ]
            }
        ];

        // –§–∏–Ω–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
        const finalEvents = {
            success: {
                title: "üéâ –ë–ª–µ—Å—Ç—è—â–∏–π —É—Å–ø–µ—Ö!",
                text: "–í—ã —Å—Ç–∞–ª–∏ –≤—ã–¥–∞—é—â–∏–º—Å—è –≤—Ä–∞—á–æ–º! –í–∞—à–∏ –∑–Ω–∞–Ω–∏—è, dedication –∏ –∑–∞–±–æ—Ç–∞ –æ –ø–∞—Ü–∏–µ–Ω—Ç–∞—Ö –ø–æ–º–æ–≥–ª–∏ –≤–∞–º –¥–æ—Å—Ç–∏—á—å –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã—Ö –≤—ã—Å–æ—Ç –≤ –º–µ–¥–∏—Ü–∏–Ω–µ. –Æ–ª—è —Å—Ç–∞–ª–∞ —Ç–µ–º –≤—Ä–∞—á–æ–º, –æ –∫–æ—Ç–æ—Ä–æ–º –º–µ—á—Ç–∞–ª–∞!"
            },
            good: {
                title: "üëç –•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç",
                text: "–í—ã —Å—Ç–∞–ª–∏ –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω—ã–º –≤—Ä–∞—á–æ–º. –•–æ—Ç—è –±—ã–ª–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏, –≤—ã —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å –∏ —Ç–µ–ø–µ—Ä—å –ø–æ–º–æ–≥–∞–µ—Ç–µ –ª—é–¥—è–º. –ö–∞—Ä—å–µ—Ä–∞ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ!"
            },
            average: {
                title: "üòê –ù–µ–ø–ª–æ—Ö–æ, –Ω–æ –º–æ–∂–Ω–æ –ª—É—á—à–µ",
                text: "–í—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏ –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ –º–æ–≥–ª–∏ –±—ã –¥–æ—Å—Ç–∏—á—å –±–æ–ª—å—à–µ–≥–æ. –í–æ–∑–º–æ–∂–Ω–æ, —Å—Ç–æ–∏—Ç –±–æ–ª—å—à–µ —É–¥–µ–ª—è—Ç—å –≤–Ω–∏–º–∞–Ω–∏—è —É—á–µ–±–µ –∏ –ø—Ä–∞–∫—Ç–∏–∫–µ."
            },
            fail: {
                title: "‚ùå –ù—É–∂–Ω–æ –±–æ–ª—å—à–µ —Å—Ç–∞—Ä–∞–Ω–∏–π",
                text: "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤—ã –Ω–µ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞. –ú–æ–∂–µ—Ç —Å—Ç–æ–∏—Ç –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–π –ø–æ–¥—Ö–æ–¥ –∫ –æ–±—É—á–µ–Ω–∏—é?"
            }
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            document.getElementById('loadingScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            showEvent(1);
            updateStats();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ
        function showEvent(eventId) {
            const event = gameEvents.find(e => e.id === eventId);
            if (!event) {
                endGame();
                return;
            }

            document.getElementById('storyText').textContent = event.text;
            document.getElementById('location').textContent = player.location;
            document.getElementById('dayCounter').textContent = `–î–µ–Ω—å ${player.day} –∏–∑ ${player.maxDays}`;

            // –û–±–Ω–æ–≤–ª—è–µ–º —ç–º–æ–¥–∑–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
            updateCharacterEmoji();

            // –û—á–∏—â–∞–µ–º –∏ —Å–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞
            const choicesContainer = document.getElementById('choicesContainer');
            choicesContainer.innerHTML = '';

            event.choices.forEach((choice, index) => {
                const button = document.createElement('button');
                button.className = `choice-btn ${index % 3 === 1 ? 'secondary' : index % 3 === 2 ? 'success' : ''}`;
                button.textContent = choice.text;
                button.onclick = () => makeChoice(choice);
                choicesContainer.appendChild(button);
            });

            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
            document.getElementById('gameScreen').classList.add('fade-in');
            setTimeout(() => {
                document.getElementById('gameScreen').classList.remove('fade-in');
            }, 500);
        }

        // –°–¥–µ–ª–∞—Ç—å –≤—ã–±–æ—Ä
        function makeChoice(choice) {
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç—ã –≤—ã–±–æ—Ä–∞
            applyEffects(choice.effect);

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            showEventResult(choice.effect);

            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ–±—ã—Ç–∏—é
            player.day += 2; // –ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ - 2 –¥–Ω—è
            player.storyProgress++;

            if (player.day >= player.maxDays) {
                endGame();
            } else {
                setTimeout(() => {
                    showEvent(choice.next);
                }, 2000);
            }
        }

        // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã
        function applyEffects(effects) {
            Object.keys(effects).forEach(stat => {
                player[stat] = Math.max(0, Math.min(100, player[stat] + effects[stat]));
            });
            updateStats();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–±—ã—Ç–∏—è
        function showEventResult(effects) {
            const resultDiv = document.getElementById('eventResult');
            let resultText = "";

            Object.keys(effects).forEach(stat => {
                if (effects[stat] > 0) {
                    resultText += `+${effects[stat]} ${getStatName(stat)}\n`;
                } else if (effects[stat] < 0) {
                    resultText += `${effects[stat]} ${getStatName(stat)}\n`;
                }
            });

            resultDiv.textContent = resultText || "–ò–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ—Ç";
            resultDiv.classList.remove('hidden');

            setTimeout(() => {
                resultDiv.classList.add('hidden');
            }, 2000);
        }

        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        function updateStats() {
            document.getElementById('healthBar').style.width = player.health + '%';
            document.getElementById('energyBar').style.width = player.energy + '%';
            document.getElementById('knowledgeBar').style.width = player.knowledge + '%';
            document.getElementById('moneyBar').style.width = Math.min(100, player.money / 100) + '%';
        }

        // –û–±–Ω–æ–≤–∏—Ç—å —ç–º–æ–¥–∑–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        function updateCharacterEmoji() {
            let emoji = "üë©‚Äç‚öïÔ∏è";
            
            if (player.energy < 30) emoji = "üò¥";
            else if (player.health < 50) emoji = "ü§ï";
            else if (player.knowledge > 70) emoji = "üë©‚Äçüéì";
            else if (player.money > 8000) emoji = "üíº";

            document.getElementById('characterEmoji').textContent = emoji;
        }

        // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        function getStatName(stat) {
            const names = {
                health: "‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ",
                energy: "‚ö° –≠–Ω–µ—Ä–≥–∏—è",
                knowledge: "üìö –ó–Ω–∞–Ω–∏—è",
                money: "üí∞ –î–µ–Ω—å–≥–∏",
                reputation: "‚≠ê –†–µ–ø—É—Ç–∞—Ü–∏—è"
            };
            return names[stat] || stat;
        }

        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
        function endGame() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('endScreen').classList.remove('hidden');

            let ending;
            const score = (player.knowledge * 0.4) + (player.reputation * 0.3) + (player.health * 0.2) + (player.money * 0.1);

            if (score >= 80) ending = finalEvents.success;
            else if (score >= 60) ending = finalEvents.good;
            else if (score >= 40) ending = finalEvents.average;
            else ending = finalEvents.fail;

            document.getElementById('endText').innerHTML = `
                <h2>${ending.title}</h2>
                <p>${ending.text}</p>
                <br>
                <p><strong>–í–∞—à–∏ –∏—Ç–æ–≥–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:</strong></p>
                <p>–ó–Ω–∞–Ω–∏—è: ${player.knowledge}% | –†–µ–ø—É—Ç–∞—Ü–∏—è: ${player.reputation}%</p>
                <p>–ó–¥–æ—Ä–æ–≤—å–µ: ${player.health}% | –§–∏–Ω–∞–Ω—Å—ã: ${player.money}‚ÇΩ</p>
            `;
        }

        // –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ
        function restartGame() {
            player = {
                health: 100,
                energy: 100,
                knowledge: 30,
                money: 5000,
                day: 1,
                maxDays: 30,
                reputation: 0,
                location: "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç",
                storyProgress: 0
            };
            document.getElementById('endScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            showEvent(1);
            updateStats();
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        function saveResults() {
            const gameData = {
                action: "julia_game_completed",
                score: player.knowledge + player.reputation,
                knowledge: player.knowledge,
                reputation: player.reputation,
                health: player.health,
                money: player.money,
                days: player.day,
                finalScore: (player.knowledge * 0.4) + (player.reputation * 0.3) + (player.health * 0.2) + (player.money * 0.1)
            };

            if (window.Telegram && Telegram.WebApp) {
                Telegram.WebApp.sendData(JSON.stringify(gameData));
            } else {
                alert("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã! –û—á–∫–∏: " + gameData.finalScore.toFixed(1));
            }
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
            if (window.Telegram && Telegram.WebApp) {
                Telegram.WebApp.ready();
                Telegram.WebApp.expand();
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã (–¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏)
            setTimeout(initGame, 2000);
        });
    </script>
</body>
</html>
